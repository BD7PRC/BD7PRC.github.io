<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BD7PRC的QSL卡展示系统</title>
  <meta name="description" content="BD7PRC 的 QSL 卡展示" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .card-img { width: 260px; height: 160px; object-fit: cover; border-radius: 0.5rem; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">
  <header class="bg-white shadow-sm">
    <div class="max-w-5xl mx-auto px-4 py-6">
      <h1 class="text-2xl font-semibold">BD7PRC的QSL卡展示系统</h1>
      <p class="text-sm text-gray-500">自动从 <code>/qsl-images/</code> 中读取呼号（由 workflow 注入）。</p>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-8">
    <section id="gallery" class="flex flex-wrap -m-4">
      <!-- cards will be injected here -->
    </section>

    <div id="empty" class="hidden text-center text-gray-500 mt-8">
      未发现 QSL 图片。请将图片放入 <code>qsl-images/</code> 文件夹并推送到仓库。
    </div>
  </main>

  <footer class="max-w-5xl mx-auto px-4 py-6 text-sm text-gray-500">
    自动生成内容由 <code>.github/workflows/update-qsl-list.yml</code> 管理。
  </footer>

  <script>
    // 占位：由 workflow 自动替换这行内部的内容为 JSON 数组（不带扩展名）
    const callsigns = ["BD3AAA", "VR2WAA"];

    function createCard(callsign) {
      const col = document.createElement('div');
      col.className = 'p-4 w-full sm:w-1/2 md:w-1/3 lg:w-1/4';
      const card = document.createElement('div');
      card.className = 'bg-white rounded-lg shadow-sm p-4 flex flex-col items-center';
      const img = document.createElement('img');
      img.className = 'card-img';
      img.loading = 'lazy';
      const base = `qsl-images/${callsign}`;
      img.src = `${base}.jpg`;
      img.onerror = () => {
        img.src = `${base}.png`;
      };
      img.alt = callsign;
      const label = document.createElement('div');
      label.className = 'mt-3 text-sm font-medium';
      label.textContent = callsign;
      card.appendChild(img);
      card.appendChild(label);
      col.appendChild(card);
      return col;
    }

    function renderGallery() {
      const gallery = document.getElementById('gallery');
      const empty = document.getElementById('empty');
      gallery.innerHTML = '';
      if (!Array.isArray(callsigns) || callsigns.length === 0) {
        empty.classList.remove('hidden');
        return;
      }
      empty.classList.add('hidden');
      callsigns.forEach(cs => {
        gallery.appendChild(createCard(cs));
      });
    }

    renderGallery();
  </script>
</body>
</html>
